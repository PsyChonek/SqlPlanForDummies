# WinGet Publishing Strategy & Migration Plan

This document outlines the strategy for publishing `SqlPlanForDummies` to the Windows Package Manager (WinGet) and the roadmap for fully automating updates.

## Phase 1: Initial Submission (Current State)
**Goal:** Establish the package in the official Microsoft repository.

The `winget-releaser` automation tool **cannot creating new packages**, it can only update existing ones. Therefore, the first version must be submitted manually using the manifests generated by our custom script.

### Steps to Complete:
1. **Trigger Release:** Run the `Release` workflow for your initial version (e.g., v1.0.0).
2. **Retrieve Manifests:** Locate the generated YAML files in the `winget/` folder of this repository.
3. **Submit to Microsoft:**
   - Fork the [microsoft/winget-pkgs](https://github.com/microsoft/winget-pkgs) repository.
   - Create the directory structure: `manifests/p/PsyChonek/SqlPlanForDummies/1.0.0` (adjusting for version).
   - Copy the 3 YAML files from your `winget/` folder into that directory.
   - Submit a Pull Request (PR) to the Microsoft repo.
4. **Wait for Approval:** Once merged, the package is officially "live" in WinGet.

---

## Phase 2: Switch to Full Automation (Planned)
**Goal:** Switch to `winget-releaser` for zero-effort updates on future releases.

**Trigger:** Perform this switch **only after** Phase 1 is approved and merged.

### 1. Preparation
1. Create a **Personal Access Token (PAT)** on GitHub:
   - Type: Classic
   - Scope: `public_repo` (required to write to Microsoft's repo fork).
2. Add to Repository Secrets:
   - Go to `Settings` > `Secrets and variables` > `Actions`.
   - Create a new repository secret named `WINGET_TOKEN`.
   - Paste the PAT value.

### 2. Code Changes
Modify `.github/workflows/release.yml` to replace the custom script with the community action.

#### Remove These Steps:
- `Generate WinGet Manifests` (The custom PowerShell script)
- `git add winget/` (from the Commit Release step)

#### Add This Step (after "Create GitHub Release"):
```yaml
      - name: Publish to WinGet
        uses: vedantmgoyal9/winget-releaser@v2
        with:
          identifier: PsyChonek.SqlPlanForDummies
          installers-regex: '\.msi$' # Only target the MSI
          token: ${{ secrets.WINGET_TOKEN }}
```

### 3. Cleanup
Once the new workflow is verified:
1. Delete `scripts/update-winget-manifests.ps1`.
2. Delete the local `winget/` folder (it is no longer needed in source control).
